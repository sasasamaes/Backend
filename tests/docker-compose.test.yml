services:
  karate:
    image: karate-test
    build:
      context: .
      dockerfile: Dockerfile.test
    volumes:
      - ./:/karate
      - ./results:/results
    environment:
      KARATE_OPTS: "-Dkarate.env=dev"
      HASURA_ENDPOINT: http://localhost:8080/v1/graphql
      HASURA_ADMIN_SECRET: ${HASURA_ADMIN_SECRET}
      FIREBASE_API_KEY: ${FIREBASE_API_KEY}
    network_mode: "host"
    command: java -jar /app/karate.jar /karate/features -o /results