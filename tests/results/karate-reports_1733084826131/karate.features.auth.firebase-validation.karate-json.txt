{"failedCount":2,"prefixedPath":"karate\/features\/auth\/firebase-validation.feature","packageQualifiedName":"karate.features.auth.firebase-validation","loopIndex":-1,"relativePath":"karate\/features\/auth\/firebase-validation.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":47291,"millis":0.047291,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url baseUrl"}},{"result":{"nanos":29375,"millis":0.029375,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"headers headers"}},{"result":{"nanos":482500,"millis":0.4825,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def loginQuery = read('queries\/login-with-firebase.graphql')"}},{"result":{"nanos":70250,"millis":0.07025,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def testToken = 'valid-firebase-token'"}},{"result":{"nanos":48208,"millis":0.048208,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def expiredToken = 'expired-firebase-token'"}},{"result":{"nanos":302458,"millis":0.302458,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def invalidToken = 'invalid-token'"}},{"result":{"nanos":99542,"millis":0.099542,"status":"passed"},"step":{"endLine":21,"line":13,"prefix":"Given","docString":"{\n  \"query\": \"#(loginQuery)\",\n  \"variables\": {\n     \"token\": \"#(testToken)\"\n   }\n}","index":0,"text":"request"}},{"result":{"nanos":3124708,"millis":3.124708,"status":"passed"},"step":{"line":22,"prefix":"When","index":1,"text":"method POST"},"stepLog":"20:21:04.973 request:\n1 > POST http:\/\/localhost:8080\/v1\/graphql\n1 > Content-Type: application\/json; charset=UTF-8\n1 > X-Hasura-Admin-Secret: \n1 > Content-Length: 483\n1 > Host: localhost:8080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.16)\n1 > Accept-Encoding: gzip,deflate\n{\"query\":\"mutation LoginWithFirebase($token: String!) {\\n  loginWithFirebase(token: $token) {      # Mutation name and input\\n    token                                 # JWT token returned\\n    user {                               # User object returned\\n      id                                 # User ID\\n      email                              # User email\\n      roles                              # User roles array\\n    }\\n  }\\n}\",\"variables\":{\"token\":\"valid-firebase-token\"}}\n\n20:21:04.975 response time in milliseconds: 2\n1 < 200\n1 < Date: Sun, 01 Dec 2024 20:21:04 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 133\n{\"errors\":[{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]}\n\n"},{"result":{"nanos":7542,"millis":0.007542,"status":"passed"},"step":{"line":23,"prefix":"Then","index":2,"text":"status 200"}},{"result":{"nanos":720167,"errorMessage":"match failed: EQUALS\n  $ | present (LIST:STRING)\n  [{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]\n  '#notpresent'\n\nkarate\/features\/auth\/firebase-validation.feature:24","millis":0.720167,"status":"failed"},"step":{"line":24,"prefix":"And","index":3,"text":"match response.errors == '#notpresent'"},"stepLog":"20:21:04.978 karate\/features\/auth\/firebase-validation.feature:24\nAnd match response.errors == '#notpresent'\nmatch failed: EQUALS\n  $ | present (LIST:STRING)\n  [{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]\n  '#notpresent'\n\nkarate\/features\/auth\/firebase-validation.feature:24\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":25,"prefix":"And","index":4,"text":"match response.data.loginWithFirebase contains { token: '#present', user: '#present' }"}}],"line":12,"description":"","durationMillis":4.932041,"failed":true,"error":"match failed: EQUALS\n  $ | present (LIST:STRING)\n  [{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]\n  '#notpresent'\n\nkarate\/features\/auth\/firebase-validation.feature:24","tags":["auth"],"executorName":"main","name":"Valid Firebase Token Authentication","startTime":1733084464970,"refId":"[1:12]","endTime":1733084464978,"exampleIndex":-1},{"sectionIndex":1,"stepResults":[{"result":{"nanos":46625,"millis":0.046625,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url baseUrl"}},{"result":{"nanos":30084,"millis":0.030084,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"headers headers"}},{"result":{"nanos":1109292,"millis":1.109292,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def loginQuery = read('queries\/login-with-firebase.graphql')"}},{"result":{"nanos":186833,"millis":0.186833,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def testToken = 'valid-firebase-token'"}},{"result":{"nanos":57667,"millis":0.057667,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def expiredToken = 'expired-firebase-token'"}},{"result":{"nanos":46125,"millis":0.046125,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def invalidToken = 'invalid-token'"}},{"result":{"nanos":115875,"millis":0.115875,"status":"passed"},"step":{"endLine":36,"line":28,"prefix":"Given","docString":"{\n  \"query\": \"#(loginQuery)\",\n  \"variables\": {\n     \"token\": \"#(expiredToken)\"\n   }\n}","index":0,"text":"request"}},{"result":{"nanos":4896833,"millis":4.896833,"status":"passed"},"step":{"line":37,"prefix":"When","index":1,"text":"method POST"},"stepLog":"20:21:04.987 request:\n1 > POST http:\/\/localhost:8080\/v1\/graphql\n1 > Content-Type: application\/json; charset=UTF-8\n1 > X-Hasura-Admin-Secret: \n1 > Content-Length: 485\n1 > Host: localhost:8080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.16)\n1 > Accept-Encoding: gzip,deflate\n{\"query\":\"mutation LoginWithFirebase($token: String!) {\\n  loginWithFirebase(token: $token) {      # Mutation name and input\\n    token                                 # JWT token returned\\n    user {                               # User object returned\\n      id                                 # User ID\\n      email                              # User email\\n      roles                              # User roles array\\n    }\\n  }\\n}\",\"variables\":{\"token\":\"expired-firebase-token\"}}\n\n20:21:04.990 response time in milliseconds: 2\n1 < 200\n1 < Date: Sun, 01 Dec 2024 20:21:04 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 133\n{\"errors\":[{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]}\n\n"},{"result":{"nanos":8334,"millis":0.008334,"status":"passed"},"step":{"line":38,"prefix":"Then","index":2,"text":"status 200"}},{"result":{"nanos":365750,"errorMessage":"match failed: CONTAINS\n  $ | actual does not contain expected (STRING:STRING)\n  'invalid \"x-hasura-admin-secret\"\/\"x-hasura-access-key\"'\n  'expired'\n\nkarate\/features\/auth\/firebase-validation.feature:39","millis":0.36575,"status":"failed"},"step":{"line":39,"prefix":"And","index":3,"text":"match response.errors[0].message contains 'expired'"},"stepLog":"20:21:04.992 karate\/features\/auth\/firebase-validation.feature:39\nAnd match response.errors[0].message contains 'expired'\nmatch failed: CONTAINS\n  $ | actual does not contain expected (STRING:STRING)\n  'invalid \"x-hasura-admin-secret\"\/\"x-hasura-access-key\"'\n  'expired'\n\nkarate\/features\/auth\/firebase-validation.feature:39\n"}],"line":27,"description":"","durationMillis":6.863418,"failed":true,"error":"match failed: CONTAINS\n  $ | actual does not contain expected (STRING:STRING)\n  'invalid \"x-hasura-admin-secret\"\/\"x-hasura-access-key\"'\n  'expired'\n\nkarate\/features\/auth\/firebase-validation.feature:39","executorName":"main","name":"Expired Token Rejection","startTime":1733084464983,"refId":"[2:27]","endTime":1733084464992,"exampleIndex":-1},{"sectionIndex":2,"stepResults":[{"result":{"nanos":45666,"millis":0.045666,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url baseUrl"}},{"result":{"nanos":30083,"millis":0.030083,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"headers headers"}},{"result":{"nanos":613334,"millis":0.613334,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def loginQuery = read('queries\/login-with-firebase.graphql')"}},{"result":{"nanos":189000,"millis":0.189,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def testToken = 'valid-firebase-token'"}},{"result":{"nanos":140875,"millis":0.140875,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def expiredToken = 'expired-firebase-token'"}},{"result":{"nanos":173875,"millis":0.173875,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def invalidToken = 'invalid-token'"}},{"result":{"nanos":395500,"millis":0.3955,"status":"passed"},"step":{"endLine":50,"line":42,"prefix":"Given","docString":"{\n  \"query\": \"#(loginQuery)\",\n  \"variables\": {\n     \"token\": \"#(invalidToken)\"\n   }\n}","index":0,"text":"request"}},{"result":{"nanos":7170959,"millis":7.170959,"status":"passed"},"step":{"line":51,"prefix":"When","index":1,"text":"method POST"},"stepLog":"20:21:05.001 request:\n1 > POST http:\/\/localhost:8080\/v1\/graphql\n1 > Content-Type: application\/json; charset=UTF-8\n1 > X-Hasura-Admin-Secret: \n1 > Content-Length: 476\n1 > Host: localhost:8080\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/11.0.16)\n1 > Accept-Encoding: gzip,deflate\n{\"query\":\"mutation LoginWithFirebase($token: String!) {\\n  loginWithFirebase(token: $token) {      # Mutation name and input\\n    token                                 # JWT token returned\\n    user {                               # User object returned\\n      id                                 # User ID\\n      email                              # User email\\n      roles                              # User roles array\\n    }\\n  }\\n}\",\"variables\":{\"token\":\"invalid-token\"}}\n\n20:21:05.004 response time in milliseconds: 2\n1 < 200\n1 < Date: Sun, 01 Dec 2024 20:21:04 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 133\n{\"errors\":[{\"message\":\"invalid \\\"x-hasura-admin-secret\\\"\/\\\"x-hasura-access-key\\\"\",\"extensions\":{\"path\":\"$\",\"code\":\"access-denied\"}}]}\n\n"},{"result":{"nanos":12125,"millis":0.012125,"status":"passed"},"step":{"line":52,"prefix":"Then","index":2,"text":"status 200"}},{"result":{"nanos":426250,"millis":0.42625,"status":"passed"},"step":{"line":53,"prefix":"And","index":3,"text":"match response.errors[0].message contains 'invalid'"}}],"executorName":"main","line":41,"name":"Invalid Token Format","description":"","durationMillis":9.197667,"startTime":1733084464996,"failed":false,"refId":"[3:41]","endTime":1733084465008,"exampleIndex":-1}],"callDepth":0,"name":"Firebase Token Validation Tests","description":"","resultDate":"2024-12-01 08:21:05 PM","durationMillis":20.993126,"passedCount":1}